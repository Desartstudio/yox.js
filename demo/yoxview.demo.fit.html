<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>YoxView 3.0 Demo</title>
		<link rel="Stylesheet" type="text/css" href="../yoxview/yoxview.css" />
        <link rel="Stylesheet" type="text/css" href="../yoxscroll/yoxscroll.css" />
        <link rel="Stylesheet" type="text/css" href="css/yoxview.demo.fit.css" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script type="text/javascript" src="../yoxview/yoxview.js"></script>
        <script type="text/javascript" src="../yoxscroll/jquery.yoxscroll.js"></script>
		<script type="text/javascript" src="../yoxview/datasources/yoxview.data.element.js"></script>
        <script type="text/javascript" src="../yoxview/datasources/yoxview.data.picasa.js"></script>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-1768050-24']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
	</head>
	<body>
		<header><h1>YoxView 3.0 Demo</h1><a href="#" style="float:right" id="addBtn">+</a></header>
		<div id="popupContainer">
            <a href="#" title="Previous" class="yoxviewControlBtn yoxviewControlBtn_prev" id="yoxviewPrev"></a>
            <a href="#" title="Next" class="yoxviewControlBtn yoxviewControlBtn_next" id="yoxviewNext"></a>
            <div id="loader"></div>
            <div id="addPanel">
                <label for="add_thumbnail">Thumbnail URL:</label><input id="add_thumbnail" value="http://yoxigen.com/yoxview/images/items/thumbnails/Forme.jpg" /><br />
                <label for="add_image">Image URL:</label><input id="add_image" value="http://yoxigen.com/yoxview/images/items/large/Forme.jpg" /><br />
                <label for="add_title">Title:</label><input id="add_title" value="Life +-, by Guy Bibi" /><br />
                <label></label><input type="button" value="Add" onclick="addItem()" style="width: 100px" />
                <hr/>
                <label for="source_input">Source URL:</label><input id="source_input" value="https://picasaweb.google.com/105098710956916751721/Plants" /><br/>
                <label></label><input type="button" value="Set source" onclick="setSource()" style="width: 100px" />
            </div>
		</div>
        <div id="info">
            <h2 id="infoTitle"></h2>
            <a href="#" id="slideshowBtn">Slideshow</a>
            <span id="itemCounter"></span>
        </div>
        <div id="thumbnailsPanel">
            <a href="#" id="thumbnailsLeft" class="thumbnailsBtn" data-yoxscroll-holdstart="scroll-left" data-yoxscroll-click="page-left"></a>
            <a href="#" id="thumbnailsRight" class="thumbnailsBtn" data-yoxscroll-holdstart="scroll-right" data-yoxscroll-click="page-right"></a>
            <div id="thumbnails" class="thumbnails yoxview"></div>
        </div>
		<script type="text/javascript">
			var popupContainer =  document.getElementById("popupContainer"),
                $thumbnailsPanel = $("#thumbnailsPanel"),
                $thumbnailsContainer = $("#thumbnails"),
                $slideshowBtn = $("#slideshowBtn"),
                $addPanel = $("#addPanel"),
				docElement = document.documentElement,
				info = document.getElementById("info"),
                infoTitle = document.getElementById("infoTitle"),
                loader = document.getElementById("loader"),
                itemCounter = document.getElementById("itemCounter"),
                isInit,
                heightToSubtract = document.getElementsByTagName("header")[0].clientHeight + info.clientHeight + $thumbnailsPanel.height() +2,
                title = document.title;
				
			function setContainerSize(){
                var height = docElement.clientHeight - heightToSubtract;
				popupContainer.style.height = height + "px";
                if (isInit)
                    $thumbnailsContainer.yoxview("update");

			}
			
			setContainerSize();

            function addItem(){
                $thumbnailsContainer.yoxview("addItems", [{
                    thumbnail: { src: document.getElementById("add_thumbnail").value },
                    url: document.getElementById("add_image").value,
                    title: document.getElementById("add_title").value,
                    "type": "image"
                }], true)
            }

            function setSource(){
                $thumbnailsContainer.yoxview("source", {
                    url: document.getElementById("source_input").value,
                    thumbsize: 104,
                    cropThumbnails: false
                })
            }

			$(window).resize(function(){
                setContainerSize();
                $thumbnailsContainer.yoxscroll("update");
            });

            $slideshowBtn.on("click", function(e){
                $thumbnailsContainer.yoxview("toggleSlideshow");
            });

            $("#addBtn").on("click", function(e){ e.preventDefault(); $addPanel.slideToggle("fast"); });
			$thumbnailsContainer.yoxview({
				delayOpen: true,
                enableKeyboard: true,
				margin: { top: 10, right: 45, bottom: 10, left: 45 },
                container: popupContainer,
                controls: {
                    prev: $("#yoxviewPrev"),
                    next: $("#yoxviewNext")
                },
                //popupPadding: 20,
                events: {
                    beforeSelect: function(e, items, data){
                        try{
                            $thumbnailsContainer.yoxscroll("scrollTo", items.newItem.thumbnail.element, { centerElement: !data });
                        }
                        catch(e){ }
                    },
                    close: function(){ info.innerHTML = "" },
                    select: function(e, item){
                        infoTitle.innerHTML = item.title || "";
                        itemCounter.innerHTML = [item.id, '/', this.items.length].join("");
                        document.title = title + (item ? " - " + item.title : "");

                    },
                    cacheStart: function(e, item){ loader.style.display = "inline" },
                    cacheEnd: function(e, item){ loader.style.display = "none" },
                    init: function(){this.selectItem(0); },
                    loadItem: function(e, item){ $(item.thumbnail.element).addClass("loadedThumbnail"); },
                    createThumbnails: function(e, data){
                        $thumbnailsContainer.yoxscroll("update");
                        if (this.initialized)
                            this.selectItem(data.items[0]);
                    },
                    slideshowStop: function(){ $slideshowBtn.removeClass("slideshowBtn_on"); },
                    slideshowStart: function(){ $slideshowBtn.addClass("slideshowBtn_on"); }
                },
                handleThumbnailClick: false,
				selectedThumbnailClass: "selectedThumbnail",
                source: [{
                    url: "https://picasaweb.google.com/105098710956916751721/Trips",
                    thumbsize: 104,
                    cropThumbnails: false
                }
                ],
                zoom: true,
                transform: true,
                //transition: "evaporate",
                transitionTime: 300
			})
            .yoxscroll({
                events: {
                    click: function(e, originalEvent){ $thumbnailsContainer.yoxview("selectItem", originalEvent.target.parentNode, "yoxscroll"); }
                },
                elements: $(".thumbnailsBtn"),
                pressedButtonClass: "enabledThumbnailsButton"
            });
            isInit = true;
		</script>
	</body>
</html>