function Yox(a,b){this.container=a;this.options=b||{};this.init()}
Yox.prototype={init:function(){if(this.options.theme){var a=new yox.eventsHandler,b,d=this;this.options.data&&(b=this.options.data instanceof yox.data?this.options.data:new yox.data(this.options.data));var f=function(e,c){var h=yox.themes[e];if(!h)throw Error("Invalid theme, '"+e+"' does not exist.");h=new h(b,$.extend({},h.defaults,c));if(!(h instanceof yox.theme))throw Error("Invalid theme, '"+e+"' is not an instance of yox.theme.");h.init(d.container,b,a,c);return h};if(this.options.theme instanceof
Array){this.themes={};for(var g=0,c;c=this.options.theme[g];g++)this.themes[c.id||c.name]=f(c.name,c.options||{})}else c=f(this.options.theme,this.options),this.modules=c.modules;$.extend(this,{destroy:function(){for(var a in this.modules){var b=this.modules[a],h=b.destroy;h&&h.call(b)}c.destroy.call(c)},data:b},a);if(this.options.events)for(var k in this.options.events)this.addEventListener(k,this.options.events[k])}delete this.init}};yox="undefined"===typeof yox?{}:yox;
$.fn.yox=function(a){return!this.length?this:this.each(function(b,d){var f=$(this).data("yox");if("string"===typeof a&&f)if(f&&f[a])f[a].apply(f,Array.prototype.slice.call(arguments,1));else throw Error("Invalid method '"+a+"'");else Object(a)===a||!a?$(this).data("yox",new Yox(this,a)):$.error("Method "+a+" does not exist on Yox.")})};
yox.utils={browser:{getCssPrefix:function(){if(arguments.callee.cache)return arguments.callee.cache;var a="-"+yox.utils.browser.getPrefix().toLowerCase()+"-";return this.cache=a},getPlatform:function(){if(arguments.callee.platform)return arguments.callee.platform;arguments.callee.platform=/(Android)|(iPhone)|(iPod)/.test(navigator.userAgent)||4E5>screen.width*screen.height?this.platforms.mobile:this.platforms.desktop;return arguments.callee.platform},getPrefix:function(){if(arguments.callee.cache)return arguments.callee.cache;
for(var a=["Moz","Webkit","O","ms"],b=document.createElement("div"),d,f,g,c=0;c<a.length&&!g;c++)f=a[c],d=f+"Transform",d in b.style&&(g=f);return arguments.callee.cache=g},platforms:{desktop:"desktop",mobile:"mobile"}},css:{addJqueryCssHook:function(a){if("undefined"===typeof jQuery)return!1;var b=yox.utils.css.getSupportedProperty(a);b&&b!==a&&(jQuery.cssHooks[a]={get:function(a){return $.css(a,b)},set:function(a,f){a.style[b]=f}});return!0},addJqueryCssHooks:function(a){for(var b=a.length;b--;)yox.utils.css.addJqueryCssHook(a[b])},
getSupportedProperty:function(a){var b,d;b=a.charAt(0).toUpperCase()+a.slice(1);var f=yox.utils.browser.getPrefix(),g=document.createElement("div");a in g.style?d=a:(b=f+b,b in g.style&&(d=b));return $.support[a]=d}},dom:{isElement:Object(HTMLElement)===HTMLElement?function(a){return a instanceof HTMLElement}:Object(Element)===Element?function(a){return a instanceof Element}:function(){return Object(el)===el&&1===el.nodeType&&"string"===typeof el.nodeName},scrollIntoView:function(a,b,d,f){function g(a){var e=
h[a]-q[a]-f;if(m[a]>e)n[a]=q[a]+e;else{var b=i[a],e=h[a]-q[a]+r[b]+f,b=m[a]+k[b];b<e&&(n[a]=q[a]+e-b)}}var c=b;b===document.body&&!$.browser.webkit&&(c=document.documentElement);var k={width:b.clientWidth,height:b.clientHeight},e=c.scrollHeight,l=c.scrollWidth,f=f||0;if(k.height>=e&&k.width>=l)return!1;if(!d)return a.scrollIntoView(),!0;var a=$(a),h=a.offset(),r={width:a.width(),height:a.height()},q={left:c.scrollLeft,top:c.scrollTop},m=$(b).offset(),n={},i={top:"height",left:"width"};g("top");g("left");
if(void 0!==n.top||void 0!==n.left)b={},n.top&&(b.scrollTop=n.top),n.left&&(b.scrollLeft=n.left),$(c).stop(!0,!0).animate(b,d)}},dimensions:{distributeMeasures:function(a){var b={top:0,bottom:0,left:0,right:0};if(a){var d="number"===typeof a,f;for(f in b)b[f]=d?a:a[f]||0}b.horizontal=b.left+b.right;b.vertical=b.top+b.bottom;return b},resize:{fill:function(a,b,d){d=d||{};a.ratio=a.ratio||a.height/a.width;var f=d.enlarge?b.width:Math.min(a.width,b.width),g=Math.round(f*a.ratio),c=b.height;if(g<c&&(c<=
a.height||d.enlarge))g=c,f=Math.round(g/a.ratio);return{left:Math.round((b.width-f)/2),top:Math.round((b.height-g)/2),width:Math.round(f),height:Math.round(g)}},fit:function(a,b,d){d=d||{};a.ratio=a.ratio||a.height/a.width;var f=d.margin||{},g=d.padding||{},c=b.width-(f.horizontal||0)-(g.horizontal||0),d=d.enlarge?c:Math.min(a.width,c),c=Math.round(d*a.ratio),k=b.height-(f.vertical||0)-(g.vertical||0);c>k&&(c=k,d=Math.round(c/a.ratio));return{left:(b.width-(f.left||0)-(f.right||0)-d)/2+(f.left||0)-
(g.left||0),top:(b.height-(f.top||0)-(f.bottom||0)-c)/2+(f.top||0)-(g.top||0),width:d,height:c}}}},performance:{debounce:function(a,b,d){var f=this,g=Array.prototype.slice.call(arguments,2);clearTimeout(a.bounceTimer);a.bounceTimer=setTimeout(function(){a.apply(f,g)},b)},throttle:function(a,b){a.bounceTimer=null;return function(){var d=this,f=arguments;clearTimeout(a.bounceTimer);a.bounceTimer=setTimeout(function(){a.apply(d,f)},b)}}},url:{queryToJson:function(a){if(!a)return null;for(var a=a.split("&"),
b={},d=a.length;d--;){var f=a[d].split("=");b[f[0]]=2==f.length?f[1]:!0}return b}}};Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),d=this,f=function(){},g=function(){return d.apply(this instanceof f?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};f.prototype=this.prototype;g.prototype=new f;return g});
yox.eventsHandler=function(){var a={_default:{}},b,d,f=this;this.triggerEvent=function(g,c,k){b=g;var e=g.split("."),g=e[0];if(e=e[1])if(e=a[e]){var l=e[g];if(l)for(var e=0,h;h=l[e];e++)h.call(this,c,k)}if(g=a._default[g])for(e=0;h=g[e];e++)h.call(this,c,k);b=void 0;if(d){for(e=0;c=d[e];e++)f.removeEventListener(c.eventName,c.eventHandler);d=void 0}};this.addEventListener=function(b,d){var f=b.split("."),e=f[0],l=f[1];l?(f=a[l])||(f=a[l]={}):f=a._default;(l=f[e])||(l=f[e]=[]);l.push(d)};this.removeEventListener=
function(f,c){if(f===b)return d=d||[],d.push({eventName:f,eventHandler:c}),!1;var k=f.split("."),e=k[0],l=k[1],h,k=!1;l?(h=a[l])||(h=a[l]={}):h=a._default;if((e=h[e])&&e.length)for(l=e.length;l--;)e[l]===c&&(e.splice(l,1),k=!0);return k}};yox.eventsHandler.prototype={bindTriggerEvent:function(a,b){var d=this;return function(f,g){return d.triggerEvent.call(a,f,g,b)}}};
yox.data=function(a){this.data=[];this.options=$.extend(!0,{},this.defaults,a);a=this.options.eventsHandler||new yox.eventsHandler;$.extend(this,a);if(this.options.events)for(var b in this.options.events)this.addEventListener(b,this.options.events[b]);this.options.source&&this.addSources(this.options.source)};
yox.data.prototype={defaults:{cache:!1},addSources:function(a){var b=[],d=a instanceof Array?a:arguments,f=this;this.triggerEvent("loadSourcesStart",d);this.isLoading=!0;for(var g=0;g<d.length;g++){var c=this.loadSource(d[g]);c&&b.push(c)}$.when.apply(this,b).done(function(){for(var a=0;a<arguments.length;a++)f.data.push(arguments[a]);f.isLoading=!1;f.triggerEvent("loadSources",Array.prototype.slice.call(arguments,0))})},clear:function(){this.triggerEvent("removeSources",this.data);this.triggerEvent("clear");
this.data=[]},countItems:function(){for(var a=0,b=this.data.length;b--;)a+=this.data[b].items.length;return a},findDataSource:function(a){for(var b in yox.data.sources){var d=yox.data.sources[b];if(d.match(a))return d}return null},getData:function(){return this.data},getDataSource:function(a){return yox.data.sources[a]},loadSource:function(a){var b=a.type?this.getDataSource(a.type):this.findDataSource(a),d=this;if(!b)return null;var f=$.Deferred(),g=function(e){d.store(a,e);f.resolve(e)},c=this.store(a);
if(c)g(c);else{a.page&&a.pageSize&&void 0===a.offset&&(a.offset=a.pageSize*a.page);if(b.map)for(var k in b.map)(c=a[k])&&(a[b.map[k]]=c);b.load(a,g,function(){f.reject()})}return f},source:function(a){this.clear();this.addSources.apply(this,arguments)},store:function(a,b){if(!this.options.cache||!window.localStorage||!a||!a.url)return!1;var d=this.namespace+".source."+a.url;if(!b)return(d=window.localStorage.getItem(d))?JSON.parse(d):null;window.localStorage.setItem(d,JSON.stringify(b));return!0}};
yox.data.source=function(){};yox.data.sources={};yox.data.source.prototype={load:function(){throw Error("'load' function isn't implemented for this data source.");},match:function(){throw Error("'match' function isn't implemented for this data source.");}};
yox.data.sources.element=function(){var a=Object(HTMLElement)===HTMLElement?function(a){return a instanceof HTMLElement}:Object(Element)===Element?function(a){return a instanceof Element}:function(){return Object(el)===el&&1===el.nodeType&&"string"===typeof el.nodeName};return{name:"element",match:function(b){return a(b)||b instanceof jQuery||b.element&&a(b.element)||b.element instanceof jQuery},load:function(a,d){var f=[];$("a:has('img')",a instanceof HTMLElement?a:a.element).each(function(){var a=
$("img:first",this)[0];f.push({thumbnail:{element:this,image:a,src:a.src},url:this.href,title:this.title||a.title,type:"image"})});var g={items:f,source:a,sourceType:"element",createThumbnails:!1};d&&d(g);return g}}}();
yox.data.sources.files=function(){var a;a=window.URL&&window.URL.createObjectURL?function(a){return window.URL.createObjectURL(a)}:window.webkitURL&&window.webkitURL.createObjectURL?function(a){return window.webkitURL.createObjectURL(a)}:function(){return null};return{name:"files",match:function(){return!1},load:function(b,d){if(!d)return!1;for(var f=[],g=0,c;c=b.files[g];g++)if(/^image\//.test(c.type)){var k=a(c);f.push({url:k,type:"image",title:c.name||c.fileName,thumbnail:{src:k}})}d({items:f,
source:b,sourceType:"files",createThumbnails:!0})}}}();
yox.data.sources.flickr=function(a){function b(a,e){return"http://farm"+a.farm+".static.flickr.com/"+a.server+"/"+(a.primary||a.id)+"_"+a.secret+e+".jpg"}function d(e,h){var d=e.photoset||e.photos,c,f=[],l=e.photoset?"/in/set-"+e.photoset.id:"";d?c=e.photoset?e.photoset.photo:e.photos.photo:e.photosets?c=e.photosets.photoset:e.collections&&(c=e.collections.collection[0].set);if(c){var r=q[h.thumbsize],k=q[h.imageSize];a.each(c,function(a,e){var c={thumbnail:{src:b(e,r)},link:(g+"photos/"+(e.owner||
h.user_id)+"/"+e.id+l).replace(/\s/g,"_"),url:b(e,k),title:d?e.title:e.title._content,type:"image",description:e.description?e.description._content:void 0};d||(c.data={photoset_id:e.id});f.push(c)})}return f}var f="flickr",g="http://www.flickr.com/",c="http://api.flickr.com/services/rest/",k=/\d+@N\d+/,e=/^http:\/\/(?:www\.)?flickr\.com\/(\w+)\/(?:([^\/]+)\/(?:(\w+)\/?(?:([^\/]+)\/?)?)?)?(?:\?(.*))?/,l={api_key:"9a220a98ef188519fb87b08d310ebdbe",format:"json"},h={imageSize:"medium",thumbsize:"thumbnail",
setThumbnail:!0,setSinglePhotosetThumbnails:!0,setTitle:!0,method:"flickr.photosets.getList",extras:"description"},r={sets:function(a,e){return{method:e||a.photoset_id?"flickr.photosets.getPhotos":"flickr.photosets.getList",photoset_id:e}},galleries:function(a,e){return{method:e?"flickr.galleries.getPhotos":"flickr.galleries.getList",gallery_id:e}},collections:function(a,e){return{method:"flickr.collections.getTree",collection_id:e}},"default":function(){return{method:"flickr.photos.search"}}},q=
{smallSquare:"_s",thumbnail:"_t",small:"_m",medium:"",large:"_b",original:"_o"};return{name:f,defaults:h,map:{pageSize:"per_page"},match:function(a){return a.url&&e.test(a.url)},load:function(m,n){function i(){a.ajax({url:c,dataType:"jsonp",data:v,jsonpCallback:"jsonFlickrApi",success:function(e){var h={source:m,sourceType:f,createThumbnails:!0};h.items=d(e,v);(e.photosets||e.collections)&&a.extend(h,{createGroups:!0});if(0<h.items.length&&(v.setThumbnail&&!v.setSinglePhotosetThumbnails||m.isSingleLink))a.extend(h,
{isGroup:!0,link:(g+"photos/"+e.photoset.owner+"/sets/"+e.photoset.id+"/").replace(/\s/g,"_"),thumbnailSrc:m.isSingleLink?void 0:b(e.photoset.photo[0],q[v.thumbsize]),title:"None"});n&&n(h)},error:function(){if(options.onLoadError)options.onLoadError("Flickr plugin encountered an error while retrieving data")}})}var s=!0,o=m.url&&m.url.match(e),p,u={},y={method:"flickr.urls.lookupUser",onData:function(a){return{user_id:a.user.id,username:a.user.username._content}}};if(m.url&&!o)return!1;if(o){var t=
o[1],w=o[2],z=o[3],x=o[4];if(o=o[5])p=yox.utils.url.queryToJson(o),a.extend(u,p);if("search"==t){u.method="flickr.photos.search";u.text=p.q;p.w&&(p.w=p.w.replace("%40","@"),p.w.match(k)&&(u.user_id=p.w));if(!p||!p.sort)u.sort="relevance";s=!1}else z?(a.extend(u,r[z||"default"](m,x)),"galleries"===z&&x&&(s=!0,y={method:"flickr.urls.lookupGallery",onData:function(a){return{gallery_id:a.gallery.id,title:a.gallery.title}}})):u.method="flickr.people.getPublicPhotos",u.username=w,u.type=z}var v=jQuery.extend({},
h,u,m,l);v.media="photos";v.user&&v.photoset_id&&(v.method="flickr.photosets.getPhotos");p=screen.width>screen.height?screen.width:screen.height;if(!v.imageSize||800>=p.width&&"medium"!=v.imageSize)v.imageSize="medium";s?a.ajax({url:c,dataType:"jsonp",data:a.extend({url:m.url,method:y.method},l),jsonpCallback:"jsonFlickrApi",success:function(e){a.extend(v,y.onData(e));i()}}):i()}}}(jQuery);
yox.data.sources.html=function(){return{name:"html",match:function(a){return yox.utils.dom.isElement(a)||a instanceof jQuery||a.element&&yox.utils.dom.isElement(a.element)||a.element instanceof jQuery},load:function(a,b){var d=[];if(a.selector&&a.element)for(var f=a.element.querySelectorAll(a.selector),g=0,c=f.length;g<c;g++){var k=f[g];d.push({element:k,name:k.id,type:"html",title:k.title||k.getAttribute("data-title"),width:k.clientWidth,height:k.clientHeight,thumbnail:{src:k.getAttribute("data-thumbnail"),
className:a.thumbnailsClass||"yox-thumbnail"}});k.parentNode.removeChild(k)}else if(a.items){d=Array.prototype.slice.call(a.items,0);g=0;for(c=d.length;g<c;g++)d[g].type="html"}b({items:d,source:a,sourceType:"html",createThumbnails:!0})}}}();
yox.data.sources.picasa=function(){function a(a,d){var f=a.match(c),g=$.extend({},h,d);if(f&&1<f.length){var i=f[2],k=f[3];g.user=f[1];i?(g.album=i,g.fields+=",entry(summary),gphoto:name"):g.fields+=",entry(title),entry(gphoto:numphotos),entry(gphoto:name),entry(link[@rel='alternate']),author,entry(summary),entry(id)";k&&$.extend(g,yox.utils.url.queryToJson(k))}g.imgmax=b(l,g.imgmax);g.thumbsize=b(g.cropThumbnails?e:l,g.thumbsize)+(g.cropThumbnails?"c":"u");return g}function b(a,e){for(var b=Math.min(e,
Math.max(screen.width,screen.height)),h=a.length,d;h-- -1&&(d=a[h])&&a[h-1]>=b;);return d}function d(a){var e=k;a.user&&"lh"!=a.user?(e+="user/"+a.user,a.album&&(e+="/album/"+a.album)):e+="all";return e}function f(a){var e=[];jQuery.each(a.feed.entry,function(a,b){var h="album"===b.category[0].term.match(/#(.*)$/)[1];if(h&&!b.gphoto$numphotos.$t)return!0;var d=b.media$group.media$content[0],c={thumbnail:{src:b.media$group.media$thumbnail[0].url},url:d.url,link:b.link[0].href,title:h?b.title.$t:b.summary.$t,
type:"image",author:{name:b.media$group.media$credit[0].$t},width:parseInt(b.gphoto$width,10),height:parseInt(b.gphoto$height,10)};c.ratio=c.height/c.width;h?(c.data={album:{name:b.gphoto$name.$t,imageCount:b.gphoto$numphotos.$t,description:b.summary.$t}},c.isLoaded=!0):$.extend(c,{width:d.width,height:d.height,ratio:d.height/d.width});e.push(c)});return e}var g=/^https?:\/\/picasaweb\.google\./,c=/^https?:\/\/picasaweb\.google\.\w+\/([^\/#\?]+)\/?([^\/#\?]+)?(?:\?([^#]*))?/,k="http://picasaweb.google.com/data/feed/api/",
e=[32,48,64,72,104,144,150,160],l=[94,110,128,200,220,288,320,400,512,576,640,720,800,912,1024,1152,1280,1440,1600].concat(e).sort(function(a,e){return a-e}),h={setThumbnail:!0,setSingleAlbumThumbnails:!0,setTitle:!0,alt:"json",cropThumbnails:!1,thumbsize:64,imgmax:l[l.length-1],fields:"category(@term),entry(category(@term)),title,entry(summary),entry(media:group(media:thumbnail(@url))),entry(media:group(media:content(@url))),entry(media:group(media:content(@width))),entry(media:group(media:content(@height))),entry(link[@rel='alternate'](@href)),entry(media:group(media:credit)),openSearch:totalResults,entry(gphoto:height),entry(gphoto:width)"};
return{name:"picasa",map:{pageSize:"max-results",offset:"start-index"},match:function(a){return a.url&&g.test(a.url)},load:function(e,b){var h=a(e.url,e);$.ajax({url:d(h),dataType:"jsonp",data:h,success:function(a){var h={source:e,sourceType:"picasa",totalItems:a.feed.openSearch$totalResults.$t};if(!a.feed.entry||0==a.feed.entry.length)h.items=[];else{var d=a.feed.category[0].term.match(/#(.*)$/)[1];"user"===d&&$.extend(h,{title:a.feed.title.$t,data:{kind:"user",author:{name:a.feed.author[0].name.$t,
link:a.feed.author[0].uri.$t}}});h.createThumbnails=!0;h.items=f(a,d)}b&&b(h)},error:function(a,e){console.log("error: ",arguments)}})}}}();
yox.data.sources.twitpic=function(a){function b(a){return(a=a.match(c))?{method:a[1],userId:a[2]}:null}function d(a,b){var d=[f,e[a.method],"/show.jsonp?username=",a.userId,"&key=",g];b.page&&d.push("&page=",b.page);return d.join("")}var f="http://api.twitpic.com/2/",g="f0be525ae803e5f60882432e925cbbc0",c=/^http:\/\/(?:www\.)?twitpic\.com\/(\w+)\/([^\/\?#]+)/,k={imageSize:"full",thumbsize:"mini",page:1},e={photos:"users"};return{name:"twitpic",defaults:k,match:function(a){return a.url&&c.test(a.url)},
load:function(e,h,c){var f=b(e.url);if(!f)return c&&c({message:"Invalid Twitpic URL, can't parse fields."}),!1;a.ajax(d(f,e),{dataType:"jsonp",success:function(a){for(var b=jQuery.extend({},k,f,e),d=[],c={name:a.name,avatar:a.avatar_url,link:a.website},r=0,p;p=a.images[r];r++)d.push({thumbnail:{src:["http://twitpic.com/show/",b.thumbsize,"/",p.short_id,"?key=",g].join("")},link:"http://twitpic.com/"+p.short_id,url:["http://twitpic.com/show/",b.imageSize,"/",p.short_id,"?key=",g].join(""),title:p.message,
type:"image",author:c});h({source:e,sourceType:"twitpic",items:d})}})}}}(jQuery);
yox.data.sources.youtube=function(a){function b(a){var b,h,d=16/9,c=!1;!a.width&&!a.height&&(a.width=720);if(a.height&&!a.width||a.width&&!a.height)"string"===typeof a.aspectRatio&&("auto"===a.aspectRatio?a.aspectRatio=4/3:(c=a.aspectRatio.split(":"),a.aspectRatio=parseInt(c[0],10)/parseInt(c[1],10))),c=a.aspectRatio===16/9,a.height?(b={height:a.height,width:a.height*d},c||(h={height:a.height,width:a.height*a.aspectRatio})):(b={width:a.width,height:a.width/d},c||(h={width:a.width,height:a.width/a.aspectRatio}));
return function(a){return a?b:h}}function d(a){var b=document.createElement("object");b.setAttribute("width","100%");b.setAttribute("height","100%");b.innerHTML="<param name='movie' value='"+a+"'</param><param name='allowFullScreen' value='true'></param><param name='wmode' value='transparent'></param><param name='allowScriptAccess' value='always'></param><embed src='"+a+"' type='application/x-shockwave-flash' allowfullscreen='true' allowscriptaccess='always' wmode='transparent' width='100%' height='100%'></embed>";
return b}function f(e,b){var h={type:"html",thumbnail:{src:e.thumbnail[b.hqThumbnails?"hqDefault":"sqDefault"]},link:e.player["default"],element:d(e.content["5"]+"&fs=1&hd=1&enablejsapi=1&playerapiid=ytplayer"+d.id++ +"&version=3"),title:e.title,id:e.id,description:e.description,duration:e.duration};a.extend(h,b.getDimensions(e.aspectRatio&&"widescreen"===e.aspectRatio));h.width&&h.height&&(h.ratio=h.height/h.width);return h}function g(e,b){var h=[];if(b.filter){var d=b.filter.match(/!([^,]+)/g),
c=b.filter.match(/(,|^)[^!,]([^,]+)/g),d=d?d.join("|").replace(/^!/,"").replace(/\|!/g,"|"):null,c=c?c.join("|").replace(/\|,/g,"|"):null;d&&(b.negativeFilterRegex=RegExp("(?:^|,)("+decodeURI()(d)+")(?:,|$)"));c&&(b.positiveFilterRegex=RegExp("(?:^|,)("+decodeURI()(c)+")(?:,|$)"))}a.each(e,function(a,e){"playlist"===b.feedType&&(e=e.video);var d;d=e.tags;if(!b.filter||!d)d=!1;else{d=d.join(",");var c=b.negativeFilterRegex&&b.negativeFilterRegex.test(d);c||(c=b.positiveFilterRegex&&!b.positiveFilterRegex.test(d));
d=c}d||h.push(f(e,b))});return h}var c=/^http:\/\/(?:www\.)?youtube.com\//,k={singleVideo:/^http:\/\/(?:www\.)?youtube.com\/watch\?v=([^\&]+)(.*)?/,playlist:/^http:\/\/(?:www\.)?youtube.com\/(?:view_play_list|my_playlists)\?p=([^\&]+)(.*)?/,user:/^http:\/\/(?:www\.)?youtube.com\/user\/([^\?]+)(?:\?(.*))?/,search:/^http:\/\/(?:www\.)?youtube.com\/results\?(.*)/};apiUrl="http://gdata.youtube.com/feeds/api/videos";fixedOptions={v:2,format:5,alt:"jsonc"};defaults={hqThumbnails:!1,aspectRatio:"auto"};
d.id=1;return{name:"youtube",match:function(a){return a.url&&c.test(a.url)},load:function(e,d){if(!d)throw Error("Can't load YouTube data, no callback provided.");var h=a.extend({},defaults,e,fixedOptions);if(e.url){var c,f;for(f in k)if(c=e.url.match(k[f])){h.feedType=f;break}if(c){switch(h.feedType){case "singleVideo":h.isSingleVideo=!0;h.url+="/"+c[1];break;case "playlist":h.url="http://gdata.youtube.com/feeds/api/playlists/"+c[1];break;case "user":h.url="http://gdata.youtube.com/feeds/api/users/"+
c[1]+"/uploads";break;case "search":h.url=apiUrl}if(c=yox.utils.url.queryToJson(2==c.length?c[1]:c[2]))c.search_query&&(c.q=c.search_query,delete c.search_query),a.extend(h,c)}}a.ajax({url:h.url,dataType:"jsonp",data:h,async:!1,jsonpCallback:"callback",success:function(a){h.getDimensions=b(h);var c={source:e,sourceType:"youtube",createThumbnails:!0};if(h.isSingleVideo&&!a.data||!h.isSingleVideo&&(!a.data.items||0===a.data.items.length))c.items=[];else if(c.items=g(h.isSingleVideo?[a.data]:a.data.items,
h),!h.isSingleVideo&&(a=a.data.title))c.title=a;d(c)},error:function(){if(h.onLoadError)h.onLoadError("YouTube plugin encountered an error while retrieving data")}})}}}(jQuery);yox.statistics=function(a,b){1===arguments.length&&(b=a,a=null);this.reporter=new yox.statistics.reporters[b.reporter||yox.statistics.defaults.reporter](b);this.category=b.category||"yox.js";var d=b.eventsHandler||new yox.eventsHandler;$.extend(this,d);if(b.events)for(var f in b.events)this.addEventListener(f,b.events[f])};
yox.statistics.prototype={report:function(a){a.category=a.category||this.category;this.reporter.report(a)}};yox.statistics.defaults={reporter:"ga"};yox.statistics.reporter=function(a){this.name=a};yox.statistics.reporters={};yox.statistics.reporter.prototype={report:function(){throw Error("'report' method isn't implemented yet for this reporter type.");}};
yox.statistics.reporters.ga=function(a){if(!_gaq)throw Error("Can't initialize Google Analytics reporter, Google Analytics isn't loaded.");this.report=function(b){_gaq.push(["_trackEvent",b.category||a.category,b.action,b.label,b.value])}};yox.statistics.reporters.ga.prototype=new yox.statistics.reporter("ga");
(function(a){a.fn.yoxscroll=function(b){if(0!=this.length){var d=a(this),f=d.data("yoxscroll");if("string"===typeof b&&f&&f[b])return f[b].apply(f,Array.prototype.slice.call(arguments,1));"object"===typeof b||!b?d.data("yoxscroll",new yox.scroll(this,b)):a.error("Method "+b+" does not exist on yox.scroll.")}return this};yox.scroll=function(a,d){this.container=a;this.init(d)};yox.scroll.prototype=function(){var b,d,f;function g(e,b,c){a(e);var d=e.getElementsByTagName("img"),h=d.length,f=new Date;
if(h){var g=0,l=function(a){c&&c.call(this,a);if((a instanceof Date||"IMG"===a.target.nodeName)&&++g===h)e.removeEventListener("load",l,!0),b&&b(h)},k=function(a){c&&c.call(this,a);++g===h&&b&&b(h);a.srcElement.detachEvent("onload",k)};if(e.addEventListener)e.addEventListener("load",l,!0);else if(e.attachEvent)for(var i=h;i--;)d[i].attachEvent("onload",k);for(i=h;i--;)d[i].complete&&l(f)}else b&&b(0)}function c(){return/(Android)|(iPhone)|(iPod)/.test(navigator.userAgent)||4E5>screen.width*screen.height}
function k(e,b){var c=a(e).data("yoxscroll-"+b);if(c){var c=c.split("-"),d=this[c.shift()];d&&d.apply(this,c)}}function e(){i=t;s=parseInt(this.elements.$slider.css("left"),10)}function l(a,b,c){var d=(a.timeStamp||new Date)-z;if(!d)return!1;x=d;z=a.timeStamp||new Date;w=a.pageX-t;t=a.pageX;this.enableDrag&&(a=s+t-i,d=Math.abs(w)/w,a>=c&&0>=a?b.css("left",a):((!w||d!==p)&&e.call(y),a<c&&u!==c?b.css("left",a=c):0<a&&0!==u&&b.css("left",a=0)),o=!0,p=d,u=a)}function h(a,e,b){var c=this.elements.$slider;
u=b?parseInt(c.css("left"),10):u;var b=u+e*p,d=0<b?(e-b)/e:b<this.minPosition?(e-this.minPosition+b)/e:1;0!==d&&(b=u+d*e*p,a*=d,e=E.getCubicBezier(d),c.css({transition:"left "+a+"s cubic-bezier("+e+")",left:b}))}function r(a){y.elements.$window.off(b,D);currentDirection=0;a.data.view.elements.$window.off(d,r);if(a.data.view.enableDrag&&0!==w){var e=Math.min(Math.abs(w)/(7*x),0.86),c=e*v,e=Math.round(1E3*e*e*v);h.call(a.data.view,c,e);o=!1;y=null}return!1}function q(h){var g=this;h.on(f,function(f){var l=
c?window.event.touches[0]:f;f.preventDefault();t=l.pageX;z=l.timeStamp||new Date;e.call(g,f);g.enableDrag&&h.css({transition:"none",left:h.css("left")});w=0;o=!1;y=g;a(window).on(b,{$slider:h,minPosition:g.minPosition,view:g},D).on(d,{view:g},r)}).on(d,function(a){a.preventDefault();var e=t,e=e>i-4&&e<i+4;(g.enableDrag&&!o||e)&&g.triggerEvent("click",a)})}var m={centerContentsIfNotScrollable:!0,events:{buttonholdstart:function(a){k.call(this,a,"holdstart")},buttonholdend:function(){this.stopScroll()},
buttonclick:function(a){k.call(this,a,"click")}},"float":"left",isHorizontal:!0,scrollByTime:0.5,scrollToEasing:"ease-in-out",scrollToElementTime:0.2,scrollVelocity:500,toggleButtons:!0},n=a(window),i,s,o=!1,p=0,u,y,t,w=0,z,x,v=2.5,c=c();b=c?"touchmove":"mousemove";f=c?"touchstart":"mousedown";d=c?"touchend":"mouseup";var A,C,B={buttonDown:function(e){e.preventDefault();var b=this,h=e.data.view.options.pressedButtonClass;h&&a(b).addClass(h);A=setTimeout(function(){n.on(d,e.data,B.holdEnd);if(!c)n.on("mouseout",
e.data,B.mouseOut);e.data.view.triggerEvent("buttonholdstart",b);A=null;C=b},200)},buttonUp:function(e){var b=e.data.view.options.pressedButtonClass;b&&a(this).removeClass(b);A&&(clearTimeout(A),e.data.view.triggerEvent("buttonclick",this),A=null)},holdEnd:function(a){n.off(d,B.holdEnd);c||n.off("mouseout",B.mouseOut);a.data.view.triggerEvent("buttonholdend",C);C=null;return!1},mouseOut:function(a){a.relatedTarget||B.holdEnd(a)}},E=function(){function a(e,b){this.x=e;this.y=b}var e=[0,0.42,0.36,1],
b=[new a(0,0),new a(e[0],e[1]),new a(e[2],e[3]),new a(1,1)],c=e.join(", ");return{getCubicBezier:function(e){if(e)return c;for(var d=[b,[],[],[]],h=[b[0]],f=1;3>=f;f++)for(j=0;j<=3-f;j++){var g=new a(Math.abs(e-1)*d[f-1][j].x+e*d[f-1][j+1].x,Math.abs(e-1)*d[f-1][j].y+e*d[f-1][j+1].y);d[f][j]=g;j||h.push(g)}e=h[3];for(f=1;4>f;f++)g=h[f],g.x/=e.x,g.y/=e.y;return[h[1].x,h[1].y,h[2].x,h[2].y].join(", ")}}}(),D=c?function(a){l.call(a.data.view,window.event.touches[0],a.data.$slider,a.data.minPosition)}:
function(a){l.call(a.data.view,a,a.data.$slider,a.data.minPosition)};return{calculateSliderSize:function(){this.elements.$slider[this.options.isHorizontal?"width":"height"](999999);var e=a("<span>").appendTo(this.elements.$slider),b=e.position().left;b||(e.css("float",this.options["float"]),b=e.position().left);e.remove();return b},destroy:function(){},init:function(e){var b=a.extend({},e),e=b.eventsHandler||new yox.eventsHandler;a.extend(this,e);e=a.extend({},b.events);delete b.events;b=a.extend(!0,
{},m,b);b.toggleButtons&&(b.events.changeStatus=function(a){this.options.elements.toggle(a.scrollEnabled)});for(var c in e){var d=b.events[c],h=e[c];d?d instanceof Array||(d=b.events[c]=[d]):d=b.events[c]=[];h instanceof Array?d=d.concat(h):"function"===typeof h&&d.push(h)}this.options=b;c=this.elements={$window:a(window),$container:a(this.container),$slider:a("<div>",{"class":"yoxscrollSlider",css:a.extend({position:"relative",top:0,left:0},b.isHorizontal?{height:"100%"}:{width:"100%"})})};a.browser.webkit&&
c.$slider[0].style.setProperty("-webkit-transform","translateZ(0)",null);e=c.$container;"static"===e.css("position")&&e.css("position","relative");e.children().appendTo(c.$slider);c.$slider.appendTo(c.$container);this.initEvents();this.update();this.initButtons();q.call(this,c.$slider);c.$slider.on("click",function(a){a.preventDefault()})},initButtons:function(){if(!this.options.elements)return!1;if(this.options.elements instanceof jQuery)this.options.elements.on(f,{view:this},B.buttonDown).on(d,
{view:this},B.buttonUp)},initEvents:function(){for(var a in this.options.events){var e=this.options.events[a];if(e instanceof Array)for(var b=0;b<e.length;b++)this.addEventListener(a,e[b]);else this.addEventListener(a,e)}},page:function(a){a="left"===a?1:-1;this.scrollBy(a*this.containerSize);this.triggerEvent("page",{pageSize:this.containerSize,direction:a})},scroll:function(a){p="left"===a?1:-1;this.scrollTo(1===p?0:this.minPosition,{easing:"cubic-bezier(.15, .03, .15, .16)"})},scrollBy:function(a){this.scrollTo(a,
{isRelative:!0,time:this.options.scrollByTime})},scrollTo:function(e,b){var b=b||{},c=this.elements.$slider,d=parseInt(c.css("left"),10),h=e instanceof jQuery,f=h?e:void 0,g=b.time;e instanceof HTMLElement&&(f=a(e),h=!0);if(h){h=f.position().left;f=f.width();if(b.centerElement)e=(this.containerSize-f)/2-h;else{var l=h+d;if(l+f>this.containerSize)e=this.containerSize-h-f;else if(0>l)e=-1*h;else return!1}g=g||this.options.scrollToElementTime}b.isRelative&&(e+=d);e=Math.min(Math.max(e,this.minPosition),
0);void 0===g&&(g=Math.abs(e-d)/this.options.scrollVelocity);0===e&&!1!==b.allowCenter&&this.options.centerContentsIfNotScrollable&&!this.enableDrag?this.elements.$slider.css({transition:"none",left:this.minPosition/2}):c.css("transition","left "+g+"s "+(b.easing||this.options.scrollToEasing)).css("left",e)},stopScroll:function(){var a=this.options.scrollVelocity/20/v;h.call(this,a/10,0,!0)},update:function(){this.elements.$container.children(":not(.yoxscrollSlider)").appendTo(this.elements.$slider);
g(this.elements.$container[0],void 0,this.updateSize.bind(this))},updateSize:function(){var a=this.calculateSliderSize();this.elements.$slider.width(a);this.containerSize=this.elements.$container.width();this.minPosition=this.containerSize-a;a=0>this.minPosition;a!==this.enableDrag&&(this.enableDrag=a,(!a&&!this.options.centerContentsIfNotScrollable||0<parseInt(a&&this.elements.$slider.css("left"),10))&&this.elements.$slider.css({transition:"none",left:0}),this.triggerEvent("changeStatus",{scrollEnabled:a}),
this.elements.$container.toggleClass("yoxscroll_scrollEnabled",this.enableDrag));this.options.centerContentsIfNotScrollable&&!a&&this.elements.$slider.css({transition:"none",left:this.minPosition/2})}}}()})(jQuery);
(function(a,b){yox.thumbnails=function(b,f){var g=this;this.container=b instanceof jQuery?b[0]:b;this.options=a.extend(!0,{},this.defaults,f);this.itemCount=0;var c=this.options.eventsHandler||new yox.eventsHandler;a.extend(this,c);this.triggerEvent=function(a,e){c.triggerEvent.call(g,a,e,g)};if(this.options.events)for(var k in this.options.events)this.addEventListener(k,this.options.events[k]);this.options.data&&this.addDataSources(this.options.data);if(!1!==this.options.handleClick){var e=function(e){var b=
this.getAttribute("data-yoxthumbIndex"),c;e.preventDefault();c=this.classList&&g.options.selectedThumbnailClass?this.classList.contains(g.options.selectedThumbnailClass):a(this).hasClass(g.options.selectedThumbnailClass);g.triggerEvent("click",{originalEvent:e,index:b,target:this,isSelected:c});c||g.select(b)};a(this.container).on("click","[data-yoxthumbindex]",e);this.addEventListener("beforeDestroy",function(){a(this.container).off("click","."+g.options.thumbnailClass,e)})}};yox.thumbnails.prototype=
{addDataSources:function(a){function b(a){for(var d=0;d<a.length;d++)c.createThumbnails(a[d])}function g(a){c.options.allowAppend||(c.clear(),this.itemCount=0);b(a)}var c=this,k=a.getData();k&&k.length&&b(k);a.addEventListener("loadSources",g);this.addEventListener("beforeDestroy",function(){a.removeEventListener("loadSources",g)});a.addEventListener("clear",function(){c.clear();this.itemCount=0})},clear:function(){this.thumbnails&&this.thumbnails.remove();this.itemCount=0;this.currentSelectedThumbnail=
null;this.thumbnails=a()},createThumbnail:function(d){var f=a("<a>",{href:d.link||d.url,title:!1!==this.options.renderThumbnailsTitle?d.title:b,"class":this.options.thumbnailClass});f.append(a("<img>",{src:this.options.useFullImages?d.url:d.thumbnail.src,alt:d.title}));return f[0]},createThumbnails:function(b){var f=this,g;this.thumbnails=this.thumbnails||a();if(!1!==b.createThumbnails){if(a.tmpl)g=a.tmpl(a.template(this.template),b.items,{options:this.options,getIndex:function(){return f.itemCount++}}),
g.appendTo(this.container),this.thumbnails=g;else{g=document.createDocumentFragment();for(var c=0,k=b.items.length;c<k;c++,this.itemCount++){var e=b.items[c],l=f.options.createThumbnail?f.options.createThumbnail.call(f,c,e,k):this.createThumbnail(e);l.setAttribute("data-yoxthumbindex",this.itemCount);e.thumbnail.element=l;e.thumbnail.generated=!0;var h=l.getElementsByTagName("img");h.length&&(e.thumbnail.image=h[0]);g.appendChild(l)}this.thumbnails=this.thumbnails.add(g.childNodes);this.container.appendChild(g)}g=
this.container.childNodes}else g=a("a:has(img)",this.container).attr("data-yoxthumbindex",function(){return f.itemCount++}),this.thumbnails=this.thumbnails.add(g),g=g.get();this.triggerEvent("create",{thumbnails:g,items:b.items})},defaults:{allowAppend:!0,renderThumbnailsTitle:!0,selectedThumbnailClass:"selectedThumbnail",thumbnailClass:"yoxthumbnail"},destroy:function(){this.triggerEvent("beforeDestroy");this.clear()},reset:function(){},select:function(a){this.unselect();this.thumbnails&&(this.currentSelectedThumbnail=
this.thumbnails.eq(a).addClass(this.options.selectedThumbnailClass))},template:"<a class='${$item.options.thumbnailClass}' href='${link || url}'{{if $item.options.renderThumbnailsTitle}} title='title'{{/if}} data-yoxthumbIndex='${$item.getIndex()}'><img src='${thumbnail.src}' alt='${title}' /></a>",unselect:function(){this.currentSelectedThumbnail&&(this.currentSelectedThumbnail.removeClass(this.options.selectedThumbnailClass),this.currentSelectedThumbnail=null)}};window.yox.thumbnails=yox.thumbnails})(jQuery);
yox.controller=function(a,b){this.options=$.extend({},yox.controller.defaults,b);var d=this.options.eventsHandler||new yox.eventsHandler;$.extend(this,d);if(this.options.events)for(var f in this.options.events)this.addEventListener(f,this.options.events[f]);if(this.options.enableKeydown&&(this.enableKeyboard(),0<this.options.keydownFrequency)){var g=this;$(document).on("keyup.yoxController",function(){g.keydownLock=!1;clearTimeout(g.keydownLockTimeoutId)})}};
yox.controller.keys={40:"down",35:"end",13:"enter",36:"home",37:"left",39:"right",32:"space",38:"up",27:"escape"};
yox.controller.prototype={destroy:function(){this.disableKeyboard()},disableKeyboard:function(){$(document).on("keydown.yoxController",this.onKeyDown)},enableKeyboard:function(){$(document).on("keydown.yoxController",{controller:this},this.onKeyDown)},onKeyDown:function(a){var b=yox.controller.keys[a.keyCode],d=a.data.controller;b&&(a.preventDefault(),d.keydownLock||(d.triggerEvent("keydown",{key:b,keyCode:a.keyCode}),0<d.options.keydownFrequency&&(d.keydownLock=!0,d.keydownLockTimeoutId=setTimeout(function(){d.keydownLock=
!1},d.options.keydownFrequency))));return!0}};yox.controller.defaults={enableKeydown:!0,keydownFrequency:0};
(function(a){yox.utils.css.addJqueryCssHooks("transition,transitionDuration,transform,transformOrigin,transformStyle,backfaceVisibility,perspective".split(","));yox.view=function(b,d,f){var g=a.extend({},d.events),c=yox.view.config,k=yox.view.config.platform[yox.utils.browser.getPlatform()],f=f||yox.view.cache;delete d.events;var d=a.extend(!0,{},c.mode[d.resizeMode||k.resizeMode||c.defaults.resizeMode],c.defaults,k,d),e;for(e in g)c=d.events[e],k=g[e],c?c instanceof Array||(c=d.events[e]=[c]):c=
d.events[e]=[],k instanceof Array?c.concat(k):"function"===typeof k&&c.push(k);this.container=b;this.$container=a(b);this.options=d;this.id=yox.view.id?++yox.view.id:1;this.cache=f;this.direction=1;for(var l in this)b=this[l],"function"===typeof b&&(this[l]=b.bind(this));this.init()};yox.view.prototype=function(){function b(a){var b="string"===typeof a?yox.view.transitions[a]:a;if(!b)throw Error('Invalid transition - "'+a+"\" doesn't exist.");a=new b;if(!(a instanceof yox.view.transition))throw Error("Invalid transition - transition constructors must have yox.view.transition as prototype.");
a.create.call(this,this.$container);this.transition=a}function d(e,b){var c=e.data(b);if(!c&&((c=k[b].create.call(this))?e.append(c):c=e[0],e.data(b,c),c!==e[0]&&(c.style.height=c.style.width="100%",c.style.display="none"),this.options.displayInfo)){var d=a("<div>",{"class":"yoxview_info"});e.append(d).data("info",d)}return c}function f(a){for(var b=[],c=this.items.length,d=0;d<a.length;d++){var f=a[d];this.items=this.items.concat(f.items);b=b.concat(f.items)}d=c;for(c=this.items.length;d<c;d++)this.items[d].id=
d+1;this.triggerEvent("load",{items:b,sources:a});this.initialized||(this.initialized=!0,this.triggerEvent("init"))}function g(a,b){if(a!==this.currentItem)return!1;if(a){var c=k[a.type],f=c.checkLoading?this.transition.getCurrentPanel():this.transition.getPanel(),g=f.data("itemType"),m=d.call(this,f,a.type);g!==a.type&&(g&&(g&&c.clear.call(this,m),f.data(g).style.display="none"),f.data("itemType",a.type));if(c.checkLoading&&!m.loading&&(!this.options.showThumbnailsBeforeLoad||b))f=this.transition.getPanel(a),
m=d.call(this,f,a.type);this.options.displayInfo&&(f=f.data("info"),a.title?f.text(a.title).removeAttr("disabled"):f.text("").attr("disabled","disabled"));m.style.display="block";c.set.call(this,a,m,b)}else this.transition.getPanel(a),this.transition.transition.call(this,{item:a}),this.triggerEvent("select",a)}var c={resizeMode:function(a){this.getPosition=yox.utils.dimensions.resize[a]},transition:function(a){this.transition.destroy.call(this);b.call(this,a);a=this.currentItem.id-1;this.currentItem=
null;this.selectItem(a)}},k={html:{clear:function(a){a.innerHTML=""},create:function(){var a=document.createElement("div");a.style.overflow="hidden";return a},set:function(a,b){b.loading=!1;a.element?(b.innerHTML="",b.appendChild(a.element)):b.innerHTML=a.html;a.width||(a.width=this.containerDimensions.width);a.height||(a.height=this.containerDimensions.height);a.ratio=a.height/a.width;this.transition.transition.call(this,{position:this.getPosition(a,this.containerDimensions,this.options),index:a.id-
1,item:a});this.triggerEvent("select",a)}},image:function(){function b(a){a=a instanceof yox.view?a:a.data.view;this.loading=!1;if(a.currentItem.url!==this.src&&a.currentItem.thumbnail.src!==this.src)return!1;if(!a.options.showThumbnailsBeforeLoad||this.loadingThumbnail){this.loadingThumbnail=!1;var e=a.currentItem,c=a.getPosition(e,a.containerDimensions,a.options);a.transition.transition.call(a,{position:c,index:e.id-1,item:e})}}return{checkLoading:!0,clear:function(a){a.src=""},create:function(){var c=
document.createElement("img");c.src="";a(c).on("load",{view:this},b);return c},set:function(a,c,d){a=d&&a.thumbnail?a.thumbnail.src:a.url;c.loading=!0;d&&(c.loadingThumbnail=!0);c.src!==a?(c.src="",c.src=a):b.call(c,this)}}}()};return{addDataSources:function(a){function b(a){f.call(c,a)}var c=this,d=a.getData();d&&d.length&&f.call(c,d);a.addEventListener("loadSources",b);this.addEventListener("beforeDestroy",function(){a.removeEventListener("loadSources",b)});a.addEventListener("clear",function(){c.removeItems()})},
cacheCount:0,close:function(){this.isOpen()&&(this.selectItem(null),this.triggerEvent("close"))},destroy:function(){this.triggerEvent("beforeDestroy");this.transition.destroy()},first:function(){if(!this.currentItem)return!1;this.selectItem(0)},items:[],init:function(){var e=this;this.options.margin=yox.utils.dimensions.distributeMeasures(this.options.margin);this.options.padding=yox.utils.dimensions.distributeMeasures(this.options.padding);var c=this.options.eventsHandler||new yox.eventsHandler;
a.extend(this,c);for(var d in this.options.events)if(c=this.options.events[d],c instanceof Array)for(var f=0;f<c.length;f++)e.addEventListener(d,c[f]);else e.addEventListener(d,c);"static"===this.$container.css("position")&&this.$container.css("position","relative");a.extend(this,{getPosition:yox.utils.dimensions.resize[this.options.resizeMode],elements:{}});b.call(this,this.options.transition);this.options.data&&this.addDataSources(this.options.data);if(this.options.controls)for(var g in this.options.controls)if(this[g])a(this.options.controls[g]).data("yoxviewControl",
g).on("click",function(b){b.preventDefault();e[a(this).data("yoxviewControl")].call(e)});this.update();this.triggerEvent("create")},isOpen:function(){return!!this.currentItem},last:function(){if(!this.currentItem)return!1;this.selectItem(this.items.length-1)},next:function(a){if(!this.currentItem)return!1;this.direction=1;this.selectItem(this.currentItem.id===this.items.length?0:this.currentItem.id,void 0,a)},option:function(b,d){var f;void 0===d&&Object(b)===b?f=b:(f={},f[b]=d);for(var g in f){var k=
this.options[g],m=f[g];if(k!==m){var n=c[g];n&&n.call(this,m,k)}}this.transition.update&&this.transition.update.call(this,f);a.extend(!0,this.options,f)},toggleSlideshow:function(){var a=this;this.isPlaying?(clearTimeout(this.playTimeoutId),this.isPlaying=!1,this.triggerEvent("slideshowStop")):(this.isPlaying=!0,this.playTimeoutId=setTimeout(function(){a.next.call(a,!0)},this.options.slideshowDelay),this.triggerEvent("slideshowStart"))},prev:function(){if(!this.currentItem)return!1;this.direction=
-1;this.selectItem(1===this.currentItem.id?this.items.length-1:this.currentItem.id-2)},removeItems:function(){this.triggerEvent("removeItems",this.items);this.currentItem=void 0;this.items=[]},removeEventListener:function(b,c){if(c&&"function"!==typeof c)throw Error("Invalid event handler, must be a function or undefined.");a(this.container).off(b+".modules",c)},selectItem:function(b,c,d){!d&&this.isPlaying?this.toggleSlideshow():d&&!this.isPlaying&&(this.isPlaying=!0,this.triggerEvent("slideshowStart"));
if(!isNaN(b)){if(b>=this.items.length||0>b)throw Error("Invalid item index: "+b);b=this.items[b]}if(""+b===b){for(var d=0,f;f=this.items[d];d++)if(f.name&&f.name===b){b=f;break}f=null}else b instanceof HTMLElement&&(b=a(b)),b instanceof jQuery&&(d=b.data("yoxviewIndex"),isNaN(d)&&(d=parseInt(b.attr("data-yoxviewIndex"),10)),b=this.items[d]);var d=this.currentItem,k=this;if(d&&b&&b.id===d.id)return!1;this.triggerEvent("beforeSelect",{newItem:b,oldItem:d,data:c});(this.currentItem=b)?(k.options.showThumbnailsBeforeLoad&&
g.call(k,b,!0),this.cache.withItem(b,this,function(a){g.call(k,a)})):g.call(k,b);return!0},unload:function(){},update:function(a){this.options.transitionTime&&this.updateTransitionTimeoutId&&(clearTimeout(this.updateTransitionTimeoutId),this.updateTransitionTimeoutId=null);var b={width:this.$container.width(),height:this.$container.height()};if(a||!this.containerDimensions||b.width!==this.containerDimensions.width||b.height!==this.containerDimensions.height)this.containerDimensions=b,this.currentItem&&
this.transition.transition.call(this,{position:this.getPosition(this.currentItem,this.containerDimensions,this.options),duration:0,isUpdate:!0})}}}();yox.view.config={defaults:{cacheImagesInBackground:!0,createInfo:void 0,enlarge:!1,events:{init:function(){this.options.cacheImagesInBackground&&this.items.length&&yox.view.cache.cacheItem(this);this.removeEventListener("init")},select:function(){var a=this;this.isPlaying&&(this.playTimeoutId=setTimeout(function(){a.next.call(a,!0)},Number(this.options.slideshowDelay)+
Number(this.options.transitionTime||0)))}},container:document.body||document.getElementsByTagName("body")[0],panelDimensions:{width:1600,height:1600},resizeMode:"fit",showThumbnailsBeforeLoad:!1,slideshowDelay:3E3},mode:{fill:{transition:"fade",enlarge:!0,margin:0,padding:0},fit:{transition:"morph"}},platform:{mobile:{cacheBuffer:2,margin:0,padding:0,showInfo:!0,transitionTime:0},desktop:{cacheBuffer:5,margin:20,padding:0,showInfo:!0,transitionTime:300}},keys:{right:"next",left:"prev",enter:"toggleSlideshow",
escape:"close",home:"first",end:"last",space:"next"}}})(jQuery);
yox.view.cache=function(){function a(a,b){var e=!0;c++;b&&++a.cacheCount===a.items.length&&(delete a.cacheCount,a.isLoaded=!0,e=!1);e&&(e=c+r<a.options.cacheBuffer);e&&d(a)}function b(b){if(!this.width||!this.height)return!1;var b=e[l=b.data.cacheImageIndex],c=b.item,d=b.view;c.width=this.width;c.height=this.height;c.ratio=this.height/this.width;c.isLoaded=!0;c.id===m&&(d.triggerEvent("cacheEnd",c),m=null);d.triggerEvent("loadItem",c);b.onCache&&(b.onCache.call(d,c),b.onCache=null);r--;delete b.item;
a(d,!0)}function d(a){var b=a.items.length,c=g+a.direction;c===b?c=0:-1===c&&(c+=b);f(a,a.items[c],null,h)}function f(b,f,i){if(!(b instanceof yox.view))throw new TypeError("Invalid view for cacheItem.");if(!b)throw Error("View is required for cacheItem.");if(4>arguments.length||arguments[3]!==h)c=0;f=f||b.items[0];if("image"!==f.type)return i&&i.call(b,f),!0;for(var m=0;m<k;m++){var n=e[m];if(n.view&&n.view.id===b.id&&n.item&&n.item.id===f.id&&i)return n.onCache=i,!0}g=f.id-1;!f.isLoaded&&"image"===
f.type?(n=e[l],n.item=f,n.view=b,$.browser.mozilla&&(n.img.src=""),i&&(n.onCache=i),n.img.src=f.url,r++,++l===e.length&&(l=0),r<k&&c+r<b.options.cacheBuffer&&d(b)):(a(b,!f.isLoaded),f.isLoaded=!0,i&&i.call(b,f));return!0}for(var g,c=0,k=2,e=[],l=0,h=(new Date).valueOf(),r=0,q,m,n=0;n<k;n++){var i=new Image;i.setAttribute("data-id",n);$(i).on("load",{cacheImageIndex:n},b).on("error",function(){console.error("Image not found or couldn't load:",this.src)});e.push({img:i})}return{cacheItem:f,withItem:function(b,
d,e){if(3>arguments.length||arguments[2]!==h)c=0;b.isLoaded?(e.call(d,b),m&&(d.triggerEvent("cacheEnd",b),m=null),g=b.id-1,d.isLoaded||a(d,!1)):(q&&clearTimeout(q),q=setTimeout(function(){b.isLoaded||(q=null,d.triggerEvent("cacheStart",b),m=b.id)},200),f(d,b,e,h))}}}();yox.view.transition=function(a){this.name=a};yox.view.transitions={};
yox.view.transition.prototype={create:function(){throw Error("'create' method isn't implemented for this transition type.");},destroy:function(){throw Error("'destroy' method isn't implemented for this transition type.");},getCurrentPanel:function(){throw Error("'getCurrentPanel' method isn't implemented for this transition type.");},getPanel:function(){throw Error("'getPanel' method isn't implemented for this transition type.");},transition:function(){throw Error("'transition' method isn't implemented for this transition type.");
},update:function(){}};
yox.view.transitions.evaporate=function(){function a(a){f=a;g=a+"ms";e=yox.utils.browser.getCssPrefix()+"transform "+g+" ease-out, opacity "+g+" ease-out"}var b,d=1,f,g,c=0,k=this,e,l;this.create=function(c){k.$container=c;c.css("perspective","800px");a(this.options.transitionTime);b=[];for(var d=0;2>d;d++){var e=$("<div>",{"class":"yoxviewImg"});e.css({position:"absolute",top:"50%",left:"50%",width:0,height:0,border:"solid 1px #666",transform:d?"translateZ(-500px)":"translateZ(0)"});e.attr("data-index",
d);b.push(e.appendTo(c))}};this.destroy=function(){k.$container.css("perspective","");for(var a=0;a<b.length;a++)b[a].remove()};this.getCurrentPanel=function(){return b[d]};this.getPanel=function(){d=d?0:1;return b[d]};this.transition=function(a){clearTimeout(l);var g=k.getCurrentPanel(),q=b[d?0:1].show(),m=a.index<c&&!(c===this.items.length-1&&0===a.index)||a.index===this.items.length-1&&!c;g.css($.extend(a.position,{display:"block",transform:m?"translateZ(500px)":"translateZ(-800px)",transition:"none",
zIndex:m?3:1}));setTimeout(function(){q.css({transform:m?"translateZ(-800px)":"translateZ(500px)",opacity:0,zIndex:m?1:3});g.css({transition:e,transform:"translateZ(0)",zIndex:2,opacity:1});c=a.index;m||(l=setTimeout(function(){q.hide()},f))},10)};this.update=function(c){if(void 0!==c.transitionTime){a(c.transitionTime);for(c=b.length;c--;)b[c].css("transitionDuration",g)}}};yox.view.transitions.evaporate.prototype=new yox.view.transition("evaporate");
yox.view.transitions.fade=function(){var a,b=1;this.create=function(b){a=[];for(var f=0;2>f;f++){var g=$("<div>",{src:"","class":"yoxviewImg"});0<f&&g.css({opacity:"0"});g.css({transition:["opacity ",this.options.transitionTime,"ms linear"].join("")});$.browser.webkit&&g[0].style.setProperty("-webkit-transform","translateZ(0)");a.push(g.appendTo(b))}};this.destroy=function(){for(var b=0;b<a.length;b++)a[b].remove()};this.getCurrentPanel=function(){return a[b]};this.getPanel=function(){b=b?0:1;return a[b]};
this.transition=function(d){if(void 0!==d.duration){if(isNaN(d.duration))throw new TypeError("Invalid value for transition time, must be a number (in milliseconds).");}else d.duration=void 0;a[b].css(d.position);this.options.enlarge&&"fill"===this.options.resizeMode?a[1].css({opacity:b}):(a[b?0:1].css({opacity:0}),a[b].css({opacity:1}))};this.update=function(d){d.resizeMode&&d.resizeMode!==this.options.resizeMode&&a[b].css(this.getPosition(this.currentItem,this.containerDimensions,this.options));
if(void 0!==d.transitionTime)for(var f=a.length;f--;)a[f].css("transitionDuration",d.transitionTime+"ms")}};yox.view.transitions.fade.prototype=new yox.view.transition("fade");
yox.view.transitions.flip=function(){var a,b,d=1,f,g=-180,c=0,k=this;this.create=function(c){k.$container=c;c.css("perspective","800px");a=$("<div>",{"class":"yoxviewFrame yoxviewFrame_"+this.options.resizeMode+" yoxviewFrame_"+yox.utils.browser.getPlatform()+" yoxviewFrame_flip"}).appendTo(c);this.options.transitionTime&&(f=this.options.transitionTime,a.css({transition:yox.utils.browser.getCssPrefix()+"transform "+f+"ms ease-out",transformStyle:"preserve-3d",width:c.width()-this.options.margin.horizontal,
left:this.options.margin.left,height:"100%",border:"none",overflow:"visible"}));b=[];for(c=0;2>c;c++){var d=$("<div>",{"class":"yoxviewImg"});d.css({backfaceVisibility:"hidden",background:"Black",position:"absolute",top:"50%",left:"50%",width:0,height:0,transform:c?"rotateY(180deg)":"rotateY(0)",marginLeft:"-"+this.options.margin.left+"px"});d.attr("data-index",c);b.push(d.appendTo(a))}};this.destroy=function(){k.$container.css("perspective","");a.remove()};this.getCurrentPanel=function(){return b[d]};
this.getPanel=function(){d=d?0:1;return b[d]};this.transition=function(b){k.getCurrentPanel().css(b.position);b.isUpdate?a.css({width:k.$container.width()-this.options.margin.horizontal,left:this.options.margin.left}):(g+=b.index<c&&!(c===this.items.length-1&&0===b.index)||b.index===this.items.length-1&&!c?-180:180,c=b.index,a.css("transform","rotateY("+g+"deg)"))};this.update=function(b){void 0!==b.transitionTime&&a.css("transitionDuration",b.transitionTime+"ms")}};
yox.view.transitions.flip.prototype=new yox.view.transition("flip");
yox.view.transitions.morph=function(){var a,b,d=1,f,g;this.create=function(c){a=$("<div>",{"class":"yoxviewFrame yoxviewFrame_"+this.options.resizeMode+" yoxviewFrame_"+yox.utils.browser.getPlatform()}).appendTo(c);this.options.transitionTime&&(g=f=this.options.transitionTime,a.css({transition:"all "+f+"ms ease-out",top:"50%",left:"50%",width:0,height:0}),$.browser.webkit&&a[0].style.setProperty("-webkit-transform","translateZ(0)"));b=[];for(c=0;2>c;c++){var d=$("<div>",{"class":"yoxviewImg"});d.css("display",
"inline");0<c&&d.css({opacity:"0"});d.css({transition:["all ",this.options.transitionTime,"ms ease-out"].join("")});$.browser.webkit&&d[0].style.setProperty("-webkit-transform","translateZ(0)");d.attr("data-index",c);b.push(d.appendTo(a))}};this.destroy=function(){a.remove()};this.getCurrentPanel=function(){return b[d]};this.getPanel=function(){d=d?0:1;return b[d]};this.transition=function(c){var k=$.extend({},c.position);if(void 0!==c.duration){if(isNaN(c.duration))throw new TypeError("Invalid value for transition time, must be a number (in milliseconds).");
}else c.duration=f;c.duration!==g&&(k.transition="all "+c.duration+"ms ease-out",g=c.duration);c.isUpdate||b[1].css("opacity",d);a.css(k)};this.update=function(c){if(void 0!==c.transitionTime){a.css("transitionDuration",c.transitionTime+"ms");for(var d=b.length;d--;)b[d].css("transitionDuration",c.transitionTime+"ms")}}};yox.view.transitions.morph.prototype=new yox.view.transition("morph");
yox.view.transitions.thumbnails=function(){function a(a){return function(){a.css("visibility","visible")}}function b(b){clearTimeout(r);clearTimeout(q);var h=d[f],i=d[f?0:1];if(b.isUpdate)h.css(b.position);else{if(b.item){var s=$(b.item.thumbnail.image),o=s.offset(),p=s.width()/b.position.width;o.top-=e.scrollTop;o.left-=e.scrollLeft;h.show().css($.extend({transition:"none",transform:["scale(",p,") translateX(",Math.round((o.left-b.position.left-b.position.width*(1-p)/2)/p),"px) translateY(",Math.round((o.top-
b.position.top-b.position.height*(1-p)/2)/p),"px) translateZ(0)"].join(""),"z-index":k+1},b.position));r=setTimeout(function(){h.css({transform:"scale(1) translateX(0) translateY(0) translateZ(0)",transition:"all "+g+"ms ease-out"})},5)}i&&c&&(o=c.offset(),p=c.width()/l.width,o.top-=e.scrollTop,o.left-=e.scrollLeft,i.css({"z-index":k,transform:["scale(",p,") translateX(",Math.round((o.left-l.left-l.width*(1-p)/2)/p),"px) translateY(",Math.round((o.top-l.top-l.height*(1-p)/2)/p),"px) translateZ(0)"].join("")}),
q=setTimeout(function(){i.hide()},g),setTimeout(a(c),g));l=b.position;(c=s)&&c.css("visibility","hidden")}}var d,f=1,g,c,k=100,e,l;this.create=function(a){function b(){var d=$("<div>",{"class":"yoxviewFrame yoxviewFrame_"+c.options.resizeMode+" yoxviewFrame_"+yox.utils.browser.getPlatform()+" yoxviewFrame_thumbnails",css:{transition:"all "+g+"ms linear",transformOrigin:"center center",display:"none","box-sizing":"border-box",position:"fixed",overflow:"visible"}}).appendTo(a);$.browser.webkit&&d[0].style.setProperty("-webkit-transform",
"translateZ(0)");var e=document.createElement("a");e.className="yoxview_close";e.onclick=c.close;d.append(e);a.append(d);return d}var c=this;g=this.options.transitionTime;d=[];for(var f=0;2>f;f++)d.push(b(f));for(e=a[0];!~["scroll","auto"].indexOf(window.getComputedStyle(e,null).overflow)&&e.parentNode&&e!==document.documentElement;)e=e.parentNode};this.destroy=function(){for(var a=0;a<d.length;a++)d[a].remove();d=[]};this.getCurrentPanel=function(){return d[f]};this.getPanel=function(){f=f?0:1;return d[f]};
var h=yox.utils.performance.throttle(b,120),r,q;this.transition=function(a){a.isUpdate?h.call(this,a):b.call(this,a)};this.update=function(){}};yox.view.transitions.thumbnails.prototype=new yox.view.transition("thumbnails");yox.theme=function(){};yox.themes={};
yox.theme.prototype={create:function(){throw Error("'create' method is not implemented for this theme.");},destroy:function(){throw Error("'destroy' method is not implemented for this theme.");},getThemeClass:function(a){return"yox-theme-"+this.name+(a?"-"+a:"")},init:function(a,b,d,f){function g(a,c,e){e.data=b;e.eventsHandler={addEventListener:function(a,b){d.addEventListener(a,b.bind(this))},triggerEvent:function(a,b,e){d.triggerEvent.call(this,a+"."+c,b,e||this)}};return new l(a,e)}if(!(b instanceof
yox.data))throw Error("Invalid data provided for theme, must be an instance of yox.data.");$.extend(this,d);this.create(a);var c=$.extend(!0,{},this.config,f.modules),k;for(k in c){var e=c[k],l=yox[k];if(!l)throw Error("Module not found: '"+k+"', can't create theme '"+this.name+"'.");var h=$(".yox"+k,a);if(e instanceof Array){this.modules[k]=[];for(var r=0;f=e[r];r++)this.modules[k].push(g(h[r],k,f))}else this.modules[k]=g(h[0],k,e)}},config:{},modules:{}};
yox.themes.classic=function(a,b){function d(){}function f(a){var b=$(a);b.toggleClass("yox-theme-classic-button-on");n.triggerEvent("toggle",{action:a.innerHTML,state:b.hasClass("yox-theme-classic-button-on")})}function g(){p&&(o=!o);o?(n.modules.view.option("resizeMode","fit"),i.gallery.style.cursor="none",i.gallery.style.height=document.documentElement.clientHeight-(z?b.thumbnailsHeight:0)+"px"):(i.gallery.style.height=y+"px",i.gallery.style.cursor="default");var a=$(window),c=o?a.on:a.off;c.call(a,
"mousemove",l);p||c.call($(document),"keydown",e);u=!1;k();f(x.fullscreen)}function c(){u=!0;p?o?document.cancelFullScreen():(i.themeContents.style.height="100%",i.themeContents.requestFullScreen()):(o=!o,i.themeContents.style.position=o?"fixed":"relative",i.themeContents.style.height=o?"100%":y,i.themeContents.style.border=o?"none":"solid 1px Black",i.themeContents.style.zIndex=o?"100":"1",g(),n.modules.scroll.updateSize())}function k(){if(u)return!1;h();n.modules.view.update(!0)}function e(a){27===
a.keyCode&&c()}function l(a){if(!t||a.pageX<t.x-3||a.pageX>t.x+3||a.pageY<t.y-3||a.pageY>t.y+3)clearTimeout(s),i.controlsPanel.style.opacity="1",i.gallery.style.cursor="default",s=setTimeout(function(){var b=i.controlsPanel.getClientRects()[0];a.pageY>=b.top&&a.pageY<=b.bottom&&a.pageX>=b.left&&a.pageX<=b.right||(i.controlsPanel.style.opacity="0",i.gallery.style.cursor="none")},1E3);t={x:a.pageX,y:a.pageY}}function h(){var a=o?document.documentElement.clientHeight:i.container.clientHeight;z&&(a-=
b.thumbnailsHeight);i.gallery.style.height=a+"px"}function r(){k();n.triggerEvent("resize")}function q(a){var b=document.createElement("a");b.innerHTML=a.title;b.className=n.getThemeClass("button")+" "+n.getThemeClass("button-"+a.action);b.setAttribute("data-action",a.action);return b}function m(a){var b=document.createElement("a"),c=n.getThemeClass("controlBtn");b.setAttribute("data-method",a);b.className=c+" "+c+"-"+a;b.innerHTML="<div></div>";return b}var n=this,i,s,o,p,u,y,t,w=b.showInfo,z=b.showThumbnails,
x={},v=a.countItems(),A={fullscreen:c,info:function(a){w=!w;i.infoPanel.style.opacity=w?"1":"0";f(a)},slideshow:function(){n.modules.view.toggleSlideshow()},thumbnails:function(a){z=!z;i.gallery.style.height=i.gallery.clientHeight+b.thumbnailsHeight*(z?-1:1)+"px";n.modules.view.update();f(a)}};this.name="classic";this.config={view:{enableKeyboard:!0,enlarge:!0,resizeMode:"fit",transition:yox.view.transitions.fade,transitionTime:300,margin:0,events:{cacheStart:function(){i.loader.style.display="inline"},
cacheEnd:function(){i.loader.style.display="none"},"click.thumbnails":function(a){this.selectItem(a.index,"scroll")},"init.view":function(){this.selectItem(this.options.firstItem||0);i.infoPanel.style.opacity="1"},slideshowStart:function(){f(x.slideshow)},slideshowStop:function(){f(x.slideshow)},beforeSelect:function(a){i.infoText.innerHTML=a.newItem.title||"";i.infoPosition.innerHTML=a.newItem.id;b.showCopyright&&(a.newItem.author?(i.copyright.href=a.newItem.author.link||a.newItem.link,i.copyright.innerHTML=
"&copy; "+(a.newItem.author.name||a.newItem.author)):i.copyright.innerHTML="")}}},thumbnails:{events:{beforeSelect:function(a){this.select(a.newItem.id-1)},loadItem:function(a){$(this.thumbnails[a.id-1]).addClass("loaded")},"create.thumbnails":function(){this.select(0)}}},scroll:{events:{"create.thumbnails":function(){this.update()},"select.thumbnails":function(a){this.scrollTo(a,{centerElement:!0,time:0.5})},resize:function(){this.updateSize()},beforeSelect:function(a){var b=a.newItem.id-1;n.modules.thumbnails.thumbnails&&
this.scrollTo(n.modules.thumbnails.thumbnails[b],{centerElement:!a.data})}},pressedButtonClass:"enabledThumbnailsButton"},statistics:{category:"yox.js Classic theme",events:{toggle:function(a){this.report({action:"Toggle",label:a.action,value:a.state?1:0})},"page.scroll":function(a){this.report({action:"Page thumbnails",value:a.direction})}}}};a.addEventListener("loadSources",function(){i.infoItemsCount.innerHTML=a.countItems();$(i.container).removeClass(n.getThemeClass("loading"))});a.addEventListener("loadSourcesStart",
function(){$(i.container).addClass(n.getThemeClass("loading"))});!1!==b.enableFullScreen&&(document.cancelFullScreen=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||d,HTMLElement.prototype.requestFullScreen=HTMLElement.prototype.requestFullScreen||HTMLElement.prototype.mozRequestFullScreen||HTMLElement.prototype.webkitRequestFullScreen||d,p=document.cancelFullScreen!==d);!1!==b.enableFullScreen&&p&&document.addEventListener(document.mozCancelFullScreen?"mozfullscreenchange":
"webkitfullscreenchange",g,!1);this.create=function(c){$(c).addClass(this.getThemeClass()+(a.isLoading?" "+this.getThemeClass("loading"):""));i={container:c,themeContents:document.createElement("div"),gallery:document.createElement("div"),viewer:document.createElement("div"),thumbnails:document.createElement("div"),thumbnailsPanel:document.createElement("div"),loader:document.createElement("div"),description:document.createElement("p"),controlsPanel:document.createElement("div"),controls:[],infoPanel:document.createElement("div"),
info:document.createElement("div"),infoText:document.createElement("div"),infoPosition:document.createElement("span"),infoItemsCount:document.createElement("span")};i.$thumbnails=$(i.thumbnails);var d=this.getThemeClass("thumbnailsBtn");i.thumbnailsPanel.className=this.getThemeClass("thumbnailsPanel");i.thumbnailsPanel.style.height=b.thumbnailsHeight-1+"px";i.thumbnailsPanel.innerHTML='<a href="#" class="'+d+" "+d+'_left" data-yoxscroll-holdstart="scroll-left" data-yoxscroll-click="page-left"></a><a href="#" class="'+
d+" "+d+'_right" data-yoxscroll-holdstart="scroll-right" data-yoxscroll-click="page-right"></a>';i.thumbnailsPanel.appendChild(i.thumbnails);this.config.scroll.elements=$("a",i.thumbnailsPanel);i.themeContents.appendChild(i.gallery);i.themeContents.className=this.getThemeClass("contents");c.appendChild(i.themeContents);i.gallery.appendChild(i.viewer);i.gallery.appendChild(i.description);i.themeContents.appendChild(i.thumbnailsPanel);i.gallery.appendChild(i.loader);i.viewer.className=this.getThemeClass("viewer")+
" yoxview";i.gallery.className=this.getThemeClass("gallery");i.thumbnails.className=this.getThemeClass("thumbnails")+" yoxthumbnails yoxscroll";i.thumbnails.style.height=b.thumbnailsHeight+"px";i.loader.className=this.getThemeClass("loader")+" yoxloader";i.description.className=this.getThemeClass("description");i.controlsPanel.className=this.getThemeClass("controls");for(var c=[{title:"Fullscreen",action:"fullscreen"},{title:"Slideshow",action:"slideshow"},{title:"Info",action:"info"},{title:"Thumbnails",
action:"thumbnails"}],d=0,e;e=c[d];d++)i.controlsPanel.appendChild(x[e.action]=q(e));$(i.controlsPanel).on("click","a",function(a){a.preventDefault();A[this.getAttribute("data-action")](this)});i.gallery.appendChild(i.controlsPanel);b.showInfo?f(x.info):i.infoPanel.style.opacity="0";b.showThumbnails&&f(x.thumbnails);c=document.createElement("div");c.className=this.getThemeClass("info-position");c.appendChild(i.infoPosition);c.appendChild(document.createTextNode(" / "));i.infoItemsCount.innerHTML=
v;i.infoPosition.innerHTML="0";c.appendChild(i.infoItemsCount);i.info.appendChild(c);i.infoText.className=this.getThemeClass("info-text");i.info.appendChild(i.infoText);b.showCopyright&&(i.copyright=document.createElement("a"),i.copyright.target="_blank",i.copyright.className=this.getThemeClass("copyright"),i.info.appendChild(i.copyright));i.infoPanel.appendChild(i.info);i.gallery.appendChild(i.infoPanel);i.infoPanel.className=this.getThemeClass("infoPanel");i.info.className=this.getThemeClass("info");
i.gallery.appendChild(m("prev"));i.gallery.appendChild(m("next"));y=i.gallery.clientHeight;h();$(i.gallery).on("mousemove",l).on("click","."+this.getThemeClass("controlBtn"),function(){n.modules.view[this.getAttribute("data-method")]()});$(window).on("resize",r)};this.destroy=function(){$(i.container).removeClass(this.getThemeClass());i.container.removeChild(i.themeContents);i=null;clearTimeout(s);$(window).off("resize",r)}};
yox.themes.classic.defaults={showCopyright:!1,showInfo:!0,showThumbnails:!0,thumbnailsHeight:61};yox.themes.classic.prototype=new yox.theme;
yox.themes.inline=function(a,b){function d(){}function f(){m&&(q=!q);q?(r=setTimeout(function(){h.$thumbnails.css({opacity:0});document.body.style.cursor="none"},3E3),l.modules.view.option("resizeMode","fit")):(clearTimeout(r),h.$thumbnails.css("opacity","1"),h.gallery.style.height=n+"px",document.body.style.cursor="default",l.modules.view.option("resizeMode","fill"));c();var a=$(window),b=q?a.on:a.off;b.call(a,"mousemove",e);m||b.call($(document),"keydown",k)}function g(){m?q?document.cancelFullScreen():
(h.gallery.style.height="100%",h.gallery.requestFullScreen()):(q=!q,h.gallery.style.position=q?"fixed":"relative",h.gallery.style.height=q?"100%":n,h.gallery.style.border=q?"none":"solid 1px Black",h.gallery.style.zIndex=q?"100":"1",f())}function c(){l.modules.view.update(!0);i=h.thumbnails.getClientRects()[0]}function k(a){27===a.keyCode&&g()}function e(a){if(!s||a.pageX<s.x-4||a.pageX>s.x+4||a.pageY<s.y-4||a.pageY>s.y+4)clearTimeout(r),h.$thumbnails.css("opacity","1"),document.body.style.cursor=
"default",r=setTimeout(function(){a.pageY>=i.top||(h.$thumbnails.css({opacity:0}),document.body.style.cursor="none")},2E3);s={x:a.pageX,y:a.pageY}}var l=this,h,r,q,m,n,i,s;this.name="inline";this.config={view:{enableKeyboard:!0,enlarge:!0,resizeMode:"fill",transition:"fade",transitionTime:300,events:{cacheStart:function(){h.loader.style.display="inline"},cacheEnd:function(){h.loader.style.display="none"},"click.thumbnails":function(a){this.selectItem(a.index)},"init.view":function(){this.selectItem(0)}}},
thumbnails:{events:{beforeSelect:function(a){this.select(a.newItem.id-1)},loadItem:function(a){$(this.thumbnails[a.id-1]).addClass("loaded")},"create.thumbnails":function(){this.select(0)}}}};document.cancelFullScreen=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||d;HTMLElement.prototype.requestFullScreen=HTMLElement.prototype.requestFullScreen||HTMLElement.prototype.mozRequestFullScreen||HTMLElement.prototype.webkitRequestFullScreen||d;(m=document.cancelFullScreen!==
d)&&document.addEventListener(document.mozCancelFullScreen?"mozfullscreenchange":"webkitfullscreenchange",f,!1);this.create=function(a){$(a).addClass(this.getThemeClass());h={container:a,title:document.createElement("h2"),gallery:document.createElement("div"),viewer:document.createElement("div"),thumbnails:document.createElement("div"),loader:document.createElement("loader"),description:document.createElement("p")};h.$thumbnails=$(h.thumbnails);a.appendChild(h.title);a.appendChild(h.gallery);a.appendChild(h.description);
h.gallery.appendChild(h.viewer);h.gallery.appendChild(h.thumbnails);h.gallery.appendChild(h.loader);h.viewer.className=this.getThemeClass("viewer")+" yoxview";h.title.className=this.getThemeClass("title");h.gallery.className=this.getThemeClass("gallery");h.thumbnails.className=this.getThemeClass("thumbnails")+" yoxthumbnails";h.loader.className=this.getThemeClass("loader")+" yoxloader";h.description.className=this.getThemeClass("description");b.title&&(h.title.innerHTML=b.title);n=h.gallery.clientHeight;
i=h.thumbnails.getClientRects()[0];$(h.gallery).on("dblclick",g);$(window).on("resize",c)};this.destroy=function(){$(h.container).removeClass(this.getThemeClass());h.container.removeChild(h.title);h.container.removeChild(h.gallery);h.container.removeChild(h.description);h=null;$(window).off("resize",c)}};yox.themes.inline.prototype=new yox.theme;
yox.themes.scroll=function(a,b){function d(){f.triggerEvent("resize")}var f=this;this.name="scroll";this.config={thumbnails:[{id:"scroller",useFullImages:!0,events:{beforeSelect:function(a){this.select(a.newItem.id-1)},"select.view":function(a){f.triggerEvent("select.thumbnails",this.thumbnails[a.id-1],"scroller")}}},{id:"thumbnails",events:{beforeSelect:function(a){this.select(a.newItem.id-1)},loadItem:function(a){$(a.thumbnail.element).addClass("loadedThumbnail")}}}],scroll:{events:{"create.thumbnails":function(a,
b){b instanceof yox.scroll&&this.update()},"select.thumbnails":function(a){this.scrollTo(a,{centerElement:!0,time:0.5})},resize:function(){this.updateSize()}},toggleButtons:!1},view:{delayOpen:!0,enableKeyboard:!0,events:{"click.thumbnails":function(a,b){"thumbnails"===b&&this.selectItem(a.index)},"click.scroll":function(a){this.selectItem(a.target.parentNode,"yoxscroll")}}}};var g;this.create=function(a){"static"===$(a).css("position")&&a!==document.body&&(a.style.position="relative");a.style.overflow=
"hidden";g=document.createElement("div");g.className=this.getThemeClass("wrapper");var f=document.createElement("div");f.className=this.getThemeClass("scroller")+" yoxview yoxthumbnails yoxscroll ";g.appendChild(f);a.appendChild(g);!1!==b.renderThumbnails&&(a=document.createElement("div"),a.className=this.getThemeClass("thumbnails")+" thumbnails yoxthumbnails",g.appendChild(a));a=document.createElement("div");a.className=this.getThemeClass("loader")+" yoxloader";g.appendChild(a);$(window).on("resize",
d)};this.destroy=function(){g.parentNode.removeChild(g);g=null;$(window).off("resize",d)}};yox.themes.scroll.prototype=new yox.theme;
yox.themes.slideshow=function(){var a,b,d,f,g=this;this.name="slideshow";this.config={view:{enableKeyboard:!0,transition:"flip",margin:10,transitionTime:600,events:{beforeSelect:function(b){a.innerHTML=b.newItem.id+" / "+this.items.length},create:function(){this.selectItem(0)}}}};this.create=function(c){function k(a,b){var c=document.createElement("a");c.className=g.getThemeClass("button")+" "+g.getThemeClass("button-"+a);c.setAttribute("data-method",a);c.setAttribute("href","#");c.textContent=b;
return c}b=c;$(c).addClass(this.getThemeClass());d=document.createElement("div");d.className=this.getThemeClass("viewer")+" yoxview";c.appendChild(d);f=document.createElement("div");f.className=this.getThemeClass("controls");c.appendChild(f);f.appendChild(k("first","First"));f.appendChild(k("prev","Previous"));c=document.createElement("span");c.className=this.getThemeClass("position");a=c;f.appendChild(c);f.appendChild(k("next","Next"));f.appendChild(k("last","Last"));$(f).on("click","a",function(a){a.preventDefault();
g.modules.view[this.getAttribute("data-method")]()})};this.destroy=function(){b.removeChild(f);b.removeChild(d);$(b).removeClass(this.getThemeClass())}};yox.themes.slideshow.prototype=new yox.theme;
yox.themes.switcher=function(a,b){function d(){g.modules.view.update()}var f,g=this,c=!1;this.name="switcher";this.config={view:{displayInfo:!0,enableKeyboard:!0,enlarge:!1,resizeMode:"fit",transition:yox.view.transitions.thumbnails,transitionTime:400,margin:{top:45,right:30,left:30,bottom:30},showThumbnailsBeforeLoad:!0,events:{"click.thumbnails":function(a,b){c&&a.isSelected?(this.close(),b.unselect()):this.selectItem(a.index)},beforeSelect:function(a){!c&&a.newItem&&(c=!0,$(f.container).addClass(g.getThemeClass("open")))},
close:function(){g.modules.view.close();c=!1;$(f.container).removeClass(g.getThemeClass("open"))},keydown:function(a){if(a=yox.view.config.keys[a.key])this[a]()}}},controller:{keydownFrequency:b.keydownFrequency}};a.addEventListener("clear",function(){g.modules.view.close()});this.create=function(a){f={background:document.createElement("div"),view:document.createElement("div"),container:a};f.background.className=this.getThemeClass("background");f.view.className=this.getThemeClass("view")+" yoxview";
a.appendChild(f.background);a.appendChild(f.view);$(window).on("resize",d);$(f.view).on("click","img",function(){g.modules.view.next()})};this.destroy=function(){f.container.removeChild(f.background);f.container.removeChild(f.view);$(window).off("resize",d);$(f.container).removeClass(g.getThemeClass("open"));f=null}};yox.themes.switcher.defaults={keydownFrequency:200,scrollDuration:500};yox.themes.switcher.prototype=new yox.theme;
yox.themes.wall=function(a,b){var d,f,g,c;function k(a,c,d,e){w+=a.dimensions.width;t.push(a);var c=c===d-1,f=(t.length-1)*b.borderWidth;if((d=w+f>=q)||c){var e=(q-f)/w,g=Math.round(t[0].dimensions.height*e),h=!0,k=d||i;g>b.thumbnailsMaxHeight&&(g=b.thumbnailsMaxHeight,h=!1);for(var l=0,m;m=t[l];l++){var n=Math.floor(m.dimensions.width*e),f=f+n;m.style.height=g+"px";h?m.style.width=n+"px":c&&(m.style.width=m.dimensions.width+"px");k&&m.style.removeProperty("display")}for(e=t.length;e--&&f<q;f++)m=
t[e],m.style.width=parseInt(m.style.width,10)+1+"px";if(!c||d)a.style.marginRight="0",t=[],w=0}else e&&a.style.removeProperty("margin-right")}function e(){var a=m.modules.thumbnails.thumbnails;if(a)for(var b=a.length,c=0,d;d=a[c];c++)k(d,c,b,!0)}function l(b){b.length&&(b=b[0],x||(x=b.source,v=b.totalItems,x.type=b.sourceType),a.countItems()>=v&&m.triggerEvent("loadedAllItems"));n=!1;$(m.container).removeClass(y)}function h(){o<u?(o++,this.style.visibility="visible",this.style.setProperty(yox.utils.browser.getCssPrefix()+
"transform","scale(1)"),this.removeEventListener("load",h,!1),setTimeout(function(){o--;s.length&&h.call(s.shift())},p)):s.push(this)}function r(){!n&&d.scrollTop>=d.scrollHeight-d.clientHeight-b.thumbnailsMaxHeight&&(n=!0,$(m.container).addClass(y),x&&(x.offset=a.countItems()+1,a.addSources([x])))}d=void 0;f=void 0;g=void 0;c=void 0;var q,m=this,n,i=!1,s=[],o=0,p=100,u=3;this.name="wall";var y=this.getThemeClass("loading"),t=[],w=0,z=yox.utils.performance.throttle(function(a){yox.utils.dom.scrollIntoView(a,
m.container,b.scrollAnimationDuration,b.scrollOffset)},300);this.config={thumbnails:{createThumbnail:function(a,c,d){var e=document.createElement("a"),f=document.createElement("img"),g={height:b.thumbnailsMaxHeight,width:Math.round(b.thumbnailsMaxHeight/c.ratio)};e.dimensions=g;f.addEventListener("load",h,!1);f.src=c.thumbnail.src;e.appendChild(f);e.setAttribute("href",c.url);e.style.display="none";k(e,a,d);return e},events:{beforeSelect:function(a){b.scrollToElementOnSelect&&a.newItem&&z(a.newItem.thumbnail.element)},
create:r}}};var x,v;l(a.getData());a.addEventListener("loadSources",l);a.addEventListener("clear",function(){x=null;t=[];w=0;i&&(i=!1,f.addEventListener("scroll",r,!1),a.addEventListener("loadSources",l),$(m.container).removeClass(m.getThemeClass("loadedAll")))});this.create=function(h){this.container=h;var k=this.getThemeClass();$(h).addClass(k).addClass(y);g=document.createElement("div");g.className=this.getThemeClass("thumbnails")+" yoxthumbnails";g.style.padding=b.padding+"px";h.appendChild(g);
q=h.clientWidth-2*b.padding;var n=document.createElement("style");n.innerHTML=" ."+k+" a[data-yoxthumbindex]{ "+["margin-right: "+b.borderWidth+"px","margin-bottom: "+b.borderWidth+"px"].join("; ")+" }";document.getElementsByTagName("head")[0].appendChild(n);$(window).on("resize",yox.utils.performance.throttle(function(){$(h).addClass(m.getThemeClass("resizing"));q=h.clientWidth-2*b.padding;t=[];w=0;e();setTimeout(function(){$(m.container).removeClass(m.getThemeClass("resizing"))},5)},50));f=h===
document.body?document:h;d=h;!$.browser.webkit&&h===document.body&&(d=document.documentElement);c=document.createElement("div");c.className=this.getThemeClass("loader");c.style.paddingBottom=b.borderWidth+b.padding+"px";h.appendChild(c);f.addEventListener("scroll",r,!1);m.addEventListener("loadedAllItems",function(){f.removeEventListener("scroll",r,!1);a.removeEventListener("loadSources",l);i=!0;$(h).addClass(m.getThemeClass("loadedAll"))})}};
yox.themes.wall.defaults={borderWidth:7,loadItemsOnScroll:!1,padding:10,scrollAnimationDuration:500,scrollOffset:60,scrollToElementOnSelect:!1,thumbnailsMaxHeight:200};yox.themes.wall.prototype=new yox.theme;